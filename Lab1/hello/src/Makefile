# Файл:  Makefile
# Автор: Andrew Salo <salo@cs.karelia.ru>
# Дата:  07.09.2004

# Makefile для сборки программы

# Компилятор
CC	= gcc # Рекурсивная переменная

# Параметры, используемые при компиляции и редактировании связей.
CFLAGS	= -c -Wall
LDFLAGS	= -Wall


# Сборка всего проекта
all: hello


# Приведение проекта в исходное состояние
clean:
	rm -vf *~ *.o hello 


# Компиляция объектного модуля main
main.o: main.c inout.h # Строка зависимостей (Цель: main.o, который зависит от файлов main.c inout.h
	$(CC) $(CFLAGS) main.c -o main.o   # Правило (действие, которое необходимо выполнить (действие по сборке))


# Компиляция объектного модуля inout
inout.o: inout.c inout.h config.h # Строка зависимостей (Цель: input.o, который зависит от файлов inout.c inout.h config.h
	$(CC) $(CFLAGS) inout.c -o inout.o # Правило (действие, которое необходимо выполнить (действие по сборке))


# Редактирование связей и сборка программы из объектных модулей
hello: main.o inout.o # Строка зависимостей (Цель: исполняемый файл hello, который зависит от объектных файлов main.o input.o
	$(CC) $(LDFLAGS) -o hello main.o inout.o # Правило (действие, которое необходимо выполнить (действие по сборке))


# "Ложные" цели 
.PHONY: all clean
# Правило для цели clean не будет работать, если в текущем каталоге будет файл clean
# Поскольку цель clean не имеет зависимостей, то она никогда не будет считаться устаревшей и, соответственно, правило никогда не будет выполнено.
# Для устранения подобных проблем и предназначена специальная декларация .PHONY, объявляющая "ложную" цель
